## 1장

- mysql 과 maria Db 의 데이터베이스 사용 점유율은 합쳐서 60프로이다(반이상을 점유하고있다. (mysql 55%))

- mysql에는 아직 중첩 루프 조인 알고리즘만 사용한다.  (오라클은 해시 조인, 병렬 조합 조인 가능)
- 상대적으로 낮은 메모리 사용

### mysql 문법(oracle 과 혼동할 수 있는 문법들 정리)

- IFNULL(열명, 대쳇 값) : 열명이 널값인 경우 대쳇값으로 반환
- IF(조건식,'참 값', '거짓 값'): 조건이 참이면 참값, 거짓이면 거짓 값
- SUBSTRING('abcdefg',2,3) : 문자열에서 2번째(b)부터 3개를 잘라서 가져온다.
- now() : 현재시간
- 날짜형식 변환방법
    - SELECT DATE_FORMAT(NOW*(), '%Y%m%d %H%i%s') AS date;
- autoincrement라는 개념 숫자 자동증가 컬럼을 생성할 수 있다. (mariadb는 sequence 기능과 autoincrement 기능 둘 다 사용 가능)
- LIMIT : 페이징 기능 때 LIMIT 키워드 사용  


## 2장

Mysql의 성능을 개선하기 위해서는 필수적으로 알아야 하는 개념이 있는데 그 개념들을 간단하게 정리한다.

그 개념들이 왜 필요한지 택시이야기를 통해 이해를 시켜주었고,그 예시를 통해 빠르게 이해할 수 있도록 도움을 얻었다. 

(간단 요약:한국 택시의 택시를 타기 위해 한국어로 말을 해야하고, 한국에 있는 지역을 말해야 한다. 기사는 그 지역을 최소한의 시간으로 가기 위해 최적의 루트를 검색한다.)

- 파서: (Mysql 엔진에 포함되는 오브젝트) 요청 들어온 SQL문을 트리구조를 형성한다. 이 때 문법 오류가 있는지 확인한다.(문법적으로 오류가 있는지 판단하여 에러 반환)

- 전처리기: (Mysql 엔진에 포함되는 오브젝트) 파서에서 생성한 트리를 토대로 SQL 구조적 문제파악(실제로 테이블이 있는지, 조회할 수 있는 권한이 있는지.. 등등)

- 옵터마이저: 전달된 파서 트리를 토대로 필요하지 않은 조건은 제거하거나 연산 과정을 단순화한다. 
실행계획을 수립하여 인덱스를 사용할지 판단한다. 
    - 실행계획을 수립하는 것 자체가 리소스를 먹는 행위이다. 시간과 리소스에 제한을 두고 실행 계획을 산정해야 하고, 모든 계획이 최적화가 되는 것은 아니다. 
- 엔진 실행기: (Mysql 엔진과 스토리지 엔진에 걸쳐 있는 오브젝트) 실행 계획을 참고하여 스토리지 엔진에서 데이터를 가져온다. 
    - mysql 엔진의 부하를 줄일려면 스토리지 엔진에서 가져오는 데이터양을 줄여야 한다. 



### DB 오브젝트 용어

- 테이블: 하나의 데이터의 집합(2차원 배열 형태) -> 모든 행의 집합
- 로우: 동일한 구조이ㅡ 데티터 항목들의 집합을 가리킨다. 
- 컬럼: 하나의 데이터 필드에 대한 값들의 집합?


- 뷰: 가상 테이블
    - 뷰를 사용하는 이유는 테이블의 모든 데이터를 보여주는게 아니라 일부의 데이터만 보여주고 싶을 떄 주로 사용한다. 
    - 일부 데이터에 대해서만 데이터를 공개하고, 노출에 민감한 데이터에 대해서는 제약을 설정할 수 있는 보안성 때문이다.
    - 여러 개의 테이블을 병합해서 활용할 때는 성능을 고려한 최적화된 뷰를 생성함으로ㅓ써 일관된 성능을 제공할 수 있다. 

- 기본 키: 
    - 클러스터형 인덱스로 작동한다. (기본 키의 구성 열 순서를 기준으로 물리적인 스토리지에 데이터가 쌓인다)
    - 기본 키를 활용하여 인덱스 스캔을 수행하면 테이블 데이터에 더 빠르게 접근할 수 있따. 
- 외래 키: 다른 테이블의 키를 조한다. 
- 인덱스: 키 값으로 실제 데이터 위치를 식별하고 데이터 접근 속도를 높이고자 생성되는, 키 기준으로 정렬된 오브젝트이다. 
    - 고유 인덱스: 인덱스 키 값이 중복되어 저장될 수 없다.
    - 비고유 인덱스: 인덱스 키 값이 중복되어 저장될 수 있다.
    - 기본 키와의 차이점은 NULL 값 허용이다.(기본키는 널값 허용 X)


### 서브 쿼리 용어

서브 쿼리는 사용되는 위치마다 명칭이 다르다. (Select,where,from 등등), 명칭은 달라도 반환하는 형태에 따라 비슷한 의미를 가질 수 있다.


- 스칼라 서브 쿼리: 주로 Select 절에서 많이 사용되며 반환값이 1개인 경우를 의미한다. 
    - 주로 집계함수와 같이 사용한다. (sum, count)


- 인라인 뷰: from 내부에서 일시적으로 뷰를 생성하는 방식
    - 인라인 뷰의 결과는 내부적으로 메모리 또는 디스크에 임시 테이블을 생성한다. 

- 중첩 서브 쿼리:WHERE 절에 있는 SELECT 절
    - 일반적인 조건절에 사용하지 않고 특정 범위내에 조건 절을 이용할 때 주로 사용한다.

### 메인 쿼리와의 관계성에 따른 SQL 용어
서브쿼리는 그 자체가 독립적인 형태로 존재할 수도 있고, 메인 쿼리와 끈끈한 관계를 유지할 수 있다. 

- 비상관 서브쿼리
    - 메인 쿼리와 서브 쿼리간에 관계가 없다.  
    - 서브 쿼리 실행 -> 메인 쿼리순으로 실행된다.
    - 옵티마이저에 따라 서브쿼리가 제거되고 하나의 메인쿼리로 통합되는 뷰 병합이 작동할 수 있다.
- 상관 서브쿼리
    - 메인쿼리와 서브쿼리가 `관계성 있음`을 의미한다. 
    - 서브쿼리가 실행되기 위해서는 메인 쿼리의 값을 받아야 하므로 끈근한 관계가 유지된다.)
        - `스칼라 서브쿼리`와 `중첩 서브쿼리` 일 때 발생한다.
    - 실행순서는 메인쿼리 -> 서브 쿼리 -> 메인쿼리


### 반환 결과에 따른 SQL 용어
서브쿼리의 결과 유형을 수치적 기준으로 구분할 수 있다. 
- 행이 1개 : 단일 행 서브 쿼리
    - 스칼라 서브쿼리와 동일하다
- 행이 2개이상 : 다중행 서브쿼리
    - 서브 쿼리 결과가 여러 건의 행으로 반횐 되는 쿼리이다. (중첩 서브쿼리에서 IN절로 받는다.)
- 행과 열이 2개 이상: 다중열 서브 쿼리
    - IN구문과 함께 사용한다.


### 조인 알고리즘 용어

- 중첩 루프 조인
- 블록 000 조인?
- 해시 조인
